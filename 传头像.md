
方案有

可以用base64传二进制数据, 但是开销太大了, 需要想办法转url

于是选择用OSS自己搭建 [[图床]]

因为AliOssService和本机的冲突了，所以直接把这个类去掉就行，不然要自己配置一个

首先在配置文件中，需要

```yml
ali:  
  oss:  
    accessKeyId: xxxxx 
    accessKeySecret: xxxxx  
    endpoint: oss-cn-beijing.aliyuncs.com  
    publicBucket: neuvifuri-board-demo-pic  
    privateBucket: neuvifuri-board-demo-pic
```

endpoint在 `概览` 中查看

![image.png](https://gitee.com/xin_accio/pic-go-images/raw/master/20250829172509873.png)


```java
public class AdminFileUploaderController {  
    @Resource  
    AliOssService aliOssService;  
  
    @PostMapping("/api-file-uploader-test")  
    @Operation(summary = "文件上传测试", description = "")  
    @ApiResponses(value = {@ApiResponse(responseCode = "200", content = {@Content(schema = @Schema(implementation = UploadAliPulblicVO.class), mediaType = "application/json")})})  
    public ICommonResult exec(  
            @RequestPart(required = true)  
            @io.swagger.v3.oas.annotations.parameters.RequestBody(  
                    description = "文件",  
                    content = @Content(  
                            mediaType = "multipart/form-data",  
                            schema = @Schema(type = "object"),  
                            schemaProperties = {  
                                    @SchemaProperty(  
                                            name = "file",  
                                            schema = @Schema(type = "file", description = "文件", format = "binary")  
                                    )  
                            }  
                    )  
            ) MultipartFile file,  
            @RequestParam(required = true) @Parameter(description = "存储桶") String bucketName,  
            @RequestParam(required = true) @Parameter(description = "存放文件夹") String dir,  
            @RequestHeader(required = false) String platform,  
            @RequestHeader(required = false) String version,  
            HttpServletRequest request  
  
    ) throws IOException {  
        IBaseUser<String> curUser = UserHolder.get(String.class).orElseThrow(() -> BizException.DATA_NOT_FOUND.withMessage("The user does not exists"));  
        String bucketNameFinal = aliOssService.getRawBucketName(bucketName);  
        String key = aliOssService.generateKey(dir, file.getOriginalFilename());  
  
        log.info("bucketName:{}, key:{}", bucketNameFinal, key, file.getInputStream());  
        aliOssService.getOssClient().putObject(bucketNameFinal, key, file.getInputStream());  
  
        UploadAliPulblicVO vo = new UploadAliPulblicVO();  
  
        vo.setKey(key);  
        vo.setHost("https://" + bucketName + "." + aliOssService.getEndpoint());  
        log.info("public: ok");  
        return new CommonResult<>(vo);  
  
  
    }  
  
}
```

![image.png](https://gitee.com/xin_accio/pic-go-images/raw/master/20250829173420090.png)

并且要设置可以公共读

然后进行跨域设置，如图

![image.png](https://gitee.com/xin_accio/pic-go-images/raw/master/20250829172556847.png)
